{extend name="index/base" /}
{block name="content"}		
<!-- start: Content -->
<div id="content" class="span10">
	
	
	<ul class="breadcrumb">
		<li>
			<i class="icon-home"></i>
			<a href="{:url('index/system/config')}">首页</a> 
			<i class="icon-angle-right"></i>
		</li>
		<li><a href="javascript:void(0);" class="title" >{:$title}</a>
			<i class="icon-angle-right"></i>
		</li>
		<li><a href="javascript:void(0);">{:$add}</a></li>
	</ul>

	<div class="row-fluid sortable">		
		<div class="box span12">
			<div class="box-header" data-original-title>
				<h2><i class="halflings-icon white th-list"></i><span class="break"></span><span class="title">{:$title}</span></h2>						
			</div>
			<div class="box-content">					                 	                       
				<form class="form-horizontal"  action="" method="POST"  enctype="multipart/form-data">
					<input type="hidden" name="material_id" value="{:$material_id}" />
					<input type="hidden" name="material_type" value="{:$title_id}" />
					<input type="hidden" name="is_file" value="-1" />
					<fieldset>
						<div class="control-group">
							<label class="control-label"><font><font>素材类型</font></font></label>
							<div class="controls">
								{foreach name="material_type" item="vo"}
								<label class="checkbox inline">
									<div class="checker {if $material_id} disabled {/if}" id="uniform-inlineCheckbox1"><span 
										{if $title_id==$vo.id}class="checked" {/if} >
										<input type="checkbox"  {if $material_id} disabled {/if} {if $title_id==$vo.id} checked="checked" {/if} alt="{:$vo.is_file}" class="inlineCheckbox1" value="{:$vo.id}"></span></div><font><font><span class="title_name{:$vo.id}">{:$vo.name}</span>
									</font></font></label>
									{/foreach}
								</div>
							</div>
							
							<div class="control-group">
								<label class="control-label" for="inputSuccess"><font><font>标签</font></font></label>
								<div class="controls">
									<input type="text" name="tag" value="{$material.tag}" >
								</div>
							</div>
							
							<div class="control-group fileInput" style="display:none;">
								<label class="control-label" for="fileInput">内容</label>
								<div class="controls">
									<div class="uploader" id="uniform-fileInput">
										<input class="input-file uniform_on"  multiple="multiple" name="file[]" id="fileInput" type="file">
										<span class="filename" style="user-select: none;">No file selected</span>
										<span class="action" style="user-select: none;">Choose File</span>
									</div>
									<span style="color:red;">多个图片，请多选</span>
								</div>
							</div>
							<div class="control-group textarea2" style="display:none;" >
								<label class="control-label" name="content" for="textarea2">内容</label>
								<div class="controls">
									<textarea  id="textarea2" name="content" style="width:650px; height:120px;">{$material.content}</textarea>
								</div>
							</div>

							<div class="control-group allfile" style="display:none;">
								<label class="control-label" for="fileInput">批量上传</label>
								<div class="controls">
									<div class="uploader" id="uniform-fileInput">
										<input class="input-file uniform_on" name="allfile"  type="file">
										<span class="filename" style="user-select: none;">No file selected</span>
										<span class="action" style="user-select: none;">Choose File</span>
									</div>
								</div>
							</div>


							<div class="form-actions">
								<button type="submit" class="btn btn-primary">保存</button>
								<button type="reset" class="btn">取消</button>
							</div>
						</fieldset>
					</form>   
					
					
					
				</div>
			</div><!--/span-->
			
		</div><!--/row-->

	</div><!--/.fluid-container-->
	
	<!-- end: Content -->
</div><!--/#content.span10-->
</div><!--/fluid-row-->



<div class="clearfix"></div>

<!-- start: JavaScript-->
<script src="__INDEX__js/jquery-1.9.1.min.js"></script>
<script src="__INDEX__js/jquery-migrate-1.0.0.min.js"></script>

<script src="__INDEX__js/jquery-ui-1.10.0.custom.min.js"></script>

<script src="__INDEX__js/jquery.ui.touch-punch.js"></script>

<script src="__INDEX__js/modernizr.js"></script>

<script src="__INDEX__js/bootstrap.min.js"></script>

<script src="__INDEX__js/jquery.cookie.js"></script>

<script src='__INDEX__js/fullcalendar.min.js'></script>

<script src='__INDEX__js/jquery.dataTables.min.js'></script>

<script src="__INDEX__js/excanvas.js"></script>
<script src="__INDEX__js/jquery.flot.js"></script>
<script src="__INDEX__js/jquery.flot.pie.js"></script>
<script src="__INDEX__js/jquery.flot.stack.js"></script>
<script src="__INDEX__js/jquery.flot.resize.min.js"></script>

<script src="__INDEX__js/jquery.chosen.min.js"></script>

<script src="__INDEX__js/jquery.uniform.min.js"></script>

<script src="__INDEX__js/jquery.cleditor.min.js"></script>

<script src="__INDEX__js/jquery.noty.js"></script>

<script src="__INDEX__js/jquery.elfinder.min.js"></script>

<script src="__INDEX__js/jquery.raty.min.js"></script>

<script src="__INDEX__js/jquery.iphone.toggle.js"></script>

<script src="__INDEX__js/jquery.uploadify-3.1.min.js"></script>

<script src="__INDEX__js/jquery.gritter.min.js"></script>

<script src="__INDEX__js/jquery.imagesloaded.js"></script>

<script src="__INDEX__js/jquery.masonry.min.js"></script>

<script src="__INDEX__js/jquery.knob.modified.js"></script>

<script src="__INDEX__js/jquery.sparkline.min.js"></script>

<script src="__INDEX__js/counter.js"></script>

<script src="__INDEX__js/retina.js"></script>

<script src="__INDEX__js/custom.js"></script>
<script>
	$(function(){

		$('.inlineCheckbox1').each(function(index, element) {
			
			if($(this).prop('checked')==true)
			{
				var is_file = $(this).attr('alt');
				if(is_file==1)
				{					
					$("input[name='is_file']").val(is_file);					
					$('.fileInput').css('display','block');
					$('.textarea2').css('display','none');
					$('.allfile').css('display','none');
				}else
				{
					$('.textarea2').css('display','block');
					$('.fileInput').css('display','none');
					$('.allfile').css('display','block');
				}
			}

		});	


		/*******表单验证********/	
		$('.btn-primary').click(function(){

			var checked = $('.inlineCheckbox1:checked').val();
			var is_file = $('.inlineCheckbox1:checked').attr('alt');
			if(checked==''||checked=='undefined')
			{
				alert("请选择素材类型");
				return false;
			}
			var tag = $("input[name='tag']").val();
			if (tag=='')
			{
				alert("请输入素材标签");
				return false;
			}
			var content = $('#textarea2').val();
			var contentFile = $("input[name='allfile']").val();
			var contentImg = $("#fileInput").val();
			if ((contentFile==''&&content==''&&is_file==0)||(contentImg==''&&is_file==1))
			{
				alert("请输入素材内容");
				return false;
			}
			$(this).html("上传中，请勿重复点击！！");
			$(this).removeClass('btn-primary');				
		})
			//实现复选框变单选
			$('.inlineCheckbox1').change(function(){
				$('.inlineCheckbox1').parent('span').each(function(index, element) {
					$(this).removeClass("checked");
				});	
				$(this).parent('span').addClass("checked");
				var cal = $(this).val()
				$("input[name='material_type']").val(cal);
				var title = $('.title_name'+cal).html();
				$('.title').html(title);
				var is_file = $(this).attr('alt');
				$("input[name='is_file']").val(is_file);
				if(is_file==1)
				{										
					$('.fileInput').css('display','block');
					$('.textarea2').css('display','none');
					$('.allfile').css('display','none');
				}else
				{
					$('.textarea2').css('display','block');
					$('.fileInput').css('display','none');
					$('.allfile').css('display','block');
				}
			})
			
			
			
			
		})
	</script>
	<!-- end: JavaScript-->
	{/block}
